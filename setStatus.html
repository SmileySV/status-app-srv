<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–ê–¥–º—ñ–Ω–∫–∞ | –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { --ios-bg: #f2f2f7; --ios-card: #ffffff; --ios-text: #1c1c1e; --ios-pink: #ff2d55; }
        body { background: var(--ios-bg); color: var(--ios-text); font-family: -apple-system, sans-serif; padding: 30px 15px; }
        .admin-card { background: var(--ios-card); border-radius: 20px; padding: 25px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .server-item { display: grid; grid-template-columns: 1.5fr 1fr 1fr 1fr; align-items: center; gap: 15px; padding: 15px 0; border-bottom: 1px solid #d1d1d6; }
        .date-input { border: 1px solid #d1d1d6; border-radius: 8px; padding: 4px; font-size: 0.9rem; }
        .json-preview { background: #1c1c1e; color: #acffac; padding: 15px; border-radius: 12px; font-family: monospace; font-size: 0.8rem; }
        .dev-label { font-size: 0.65rem; color: #6e6e73; font-weight: 700; text-transform: uppercase; margin-bottom: 4px; display: block; }
        .switch-updating:checked { background-color: var(--ios-pink); border-color: var(--ios-pink); }
    </style>
</head>
<body>

<div class="container" style="max-width: 950px;">
    <div class="admin-card">
        <div class="d-flex justify-content-between mb-4">
            <h2 class="h4 fw-bold m-0">‚öôÔ∏è –ö–µ—Ä—É–≤–∞–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞–º–∏</h2>
            <a href="index.html" class="btn btn-sm btn-outline-secondary rounded-pill">–ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
        </div>
        <div id="controls-list"></div>
    </div>

    <div class="admin-card">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="h5 fw-bold m-0">üìÑ JSON –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è</h2>
            <div>
                <span id="copy-msg" class="text-success small me-2" style="display:none">–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!</span>
                <button class="btn btn-sm btn-primary rounded-pill px-4" onclick="copyJson()">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏</button>
            </div>
        </div>
        <pre class="json-preview" id="json-output"></pre>
    </div>
</div>

<script>
    let currentData = [];

    const toInp = d => { const p = d.split('.'); return `${p[2]}-${p[1]}-${p[0]}`; };
    const toDot = d => { const p = d.split('-'); return `${p[2]}.${p[1]}.${p[0]}`; };

    fetch('data.json').then(r => r.json()).then(data => {
        currentData = data;
        render();
    });

    function render() {
        const list = document.getElementById('controls-list');
        list.innerHTML = '';
        currentData.forEach((s, i) => {
            const div = document.createElement('div');
            div.className = 'server-item';
            div.innerHTML = `
                <div><div class="fw-bold">${s.name}</div><div class="small text-muted">${s.ip}</div></div>
                <div><span class="dev-label">–î–∞—Ç–∞:</span><input type="date" class="date-input" lang="uk-UA" value="${toInp(s.date)}" onchange="uDt(${i},this.value)"></div>
                <div class="text-center"><span class="dev-label">–†–æ–∑—Ä–æ–±–∫–∞:</span><div class="form-check form-switch d-inline-block"><input class="form-check-input" type="checkbox" ${s.dev?'checked':''} onchange="tDv(${i})"></div></div>
                <div class="text-center"><span class="dev-label">–°—Ç–∞—Ç—É—Å:</span><div class="form-check form-switch d-inline-block"><input class="form-check-input switch-updating" type="checkbox" ${s.status==='Updating'?'checked':''} onchange="tSt(${i})"></div><div class="small fw-bold ${s.status==='Updating'?'text-danger':'text-success'}">${s.status}</div></div>
            `;
            list.appendChild(div);
        });
        document.getElementById('json-output').textContent = JSON.stringify(currentData, null, 4);
    }

    function uDt(i, v) { if(v) currentData[i].date = toDot(v); render(); }
    function tDv(i) { currentData[i].dev = !currentData[i].dev; render(); }
    function tSt(i) { currentData[i].status = currentData[i].status === 'Online' ? 'Updating' : 'Online'; render(); }

    function copyJson() {
        const ta = document.createElement("textarea");
        ta.value = document.getElementById('json-output').textContent;
        document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
        const m = document.getElementById('copy-msg'); m.style.display = 'inline'; setTimeout(()=>m.style.display='none', 2000);
    }
</script>
</body>
</html>